<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Absensi Taruna TPI F</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      margin: 0; padding: 20px; min-height: 100vh;
    }
    .container {
      max-width: 1200px; margin: 0 auto; background: white;
      border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: linear-gradient(45deg, #2c3e50, #3498db);
      color: white; padding: 30px; text-align: center;
    }
    .header h1 { margin: 0 0 10px; font-size: 2.5em; font-weight: 300; }
    .header p { margin: 0; opacity: 0.9; font-size: 1.1em; }
    .content { padding: 30px; }
    .preview-section h2 {
      color: #2c3e50; border-bottom: 3px solid #3498db;
      padding-bottom: 10px; margin-bottom: 20px;
    }
    .table-container {
      overflow-x: auto; border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    table { width: 100%; border-collapse: collapse; background: white; }
    th {
      background: linear-gradient(45deg, #34495e, #2c3e50);
      color: white; padding: 12px; text-align: left;
      font-weight: 600; position: sticky; top: 0; z-index: 10;
    }
    td { padding: 10px; border-bottom: 1px solid #ecf0f1; }
    tr:nth-child(even) { background-color: #f8f9fa; }
    tr:hover { background-color: #e3f2fd !important; }
    .checkbox-cell { text-align: center; width: 150px; }
    select {
      padding: 5px; border-radius: 5px; border: 1px solid #ccc;
    }
    .stats {
      display: flex; justify-content: space-around; gap: 10px;
      margin: 20px 0; flex-wrap: wrap;
    }
    .stat-card {
      flex: 1; min-width: 150px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white; padding: 15px; border-radius: 10px;
      text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .stat-number { font-size: 2em; font-weight: bold; margin-bottom: 5px; }
    .lists-container {
      display: grid; grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
      gap: 20px; margin-top: 20px;
    }
    .list-section {
      background: #f8f9fa; padding: 20px; border-radius: 10px;
      border-left: 5px solid #3498db;
    }
    .list-section h3 {
      margin: 0 0 10px; color: #2c3e50; font-size: 1.2em;
      display: flex; align-items: center;
    }
    .name-list {
      max-height: 200px; overflow-y: auto;
      background: white; border-radius: 5px; padding: 10px;
    }
    .name-item { padding: 6px 0; border-bottom: 1px solid #ecf0f1; }
    .name-item:last-child { border-bottom: none; }
    .copy-icon {
      font-size: 0.9em; cursor: pointer; margin-left: 8px;
      opacity: 0.7; transition: opacity 0.2s ease;
    }
    .copy-icon:hover { opacity: 1; }
    .action-btn {
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      color: white; border: none; padding: 12px 30px;
      font-size: 1em; font-weight: 600;
      border-radius: 50px; cursor: pointer;
      box-shadow: 0 5px 15px rgba(46,204,113,0.3);
      transition: all 0.3s ease; margin: 10px auto; display: block;
    }
    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(46,204,113,0.4);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>âš“ Absensi Taruna TPI F ğŸ”¥</h1>
      <p>Absensi dengan rekap via WhatsApp</p>
      <p>by.@fthrrzl_qa</p>
    </div>

    <div class="content">
      <div class="preview-section">
        <h2>ğŸ“‹ Preview Daftar Hadir</h2>
        <div class="table-container">
          <table id="attendanceTable">
            <thead>
              <tr>
                <th>No</th>
                <th>Nama Taruna</th>
                <th>NRP</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="attendanceBody"></tbody>
          </table>
        </div>
      </div>

      <div class="preview-section">
        <h2>ğŸ“Š Rekap Absensi Real-time</h2>
        <div class="stats">
          <div class="stat-card">
            <div class="stat-number" id="totalHadir">0</div>
            <div class="stat-label">Hadir</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalAbsen">0</div>
            <div class="stat-label">Tidak Hadir</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalIzin">0</div>
            <div class="stat-label">Izin</div>
          </div>
        </div>

        <div class="lists-container">
          <div class="list-section">
            <h3>âœ… Hadir <span class="copy-icon" onclick="copyList('hadir')">ğŸ“‹</span></h3>
            <div class="name-list" id="hadirList">
              <div class="name-item" style="text-align:center;color:#7f8c8d;font-style:italic;">Belum ada yang hadir</div>
            </div>
          </div>
          <div class="list-section">
            <h3>âŒ Tidak Hadir <span class="copy-icon" onclick="copyList('absen')">ğŸ“‹</span></h3>
            <div class="name-list" id="absenList">
              <div class="name-item" style="text-align:center;color:#7f8c8d;font-style:italic;">Semua taruna hadir</div>
            </div>
          </div>
          <div class="list-section">
            <h3>ğŸŸ¡ Izin <span class="copy-icon" onclick="copyList('izin')">ğŸ“‹</span></h3>
            <div class="name-list" id="izinList">
              <div class="name-item" style="text-align:center;color:#7f8c8d;font-style:italic;">Tidak ada izin</div>
            </div>
          </div>
        </div>
      </div>

      <button class="action-btn" onclick="resetStatus()">ğŸ”„ Reset Absensi</button>
      <button class="action-btn" onclick="sendWhatsApp()">ğŸ“² Kirim Rekapan via WhatsApp</button>
    </div>
  </div>

<script>
  const tarunaData = [
    {no: 1, nama: "Ade James Bill Kevin Hati", nrp: "59231115241"},
    {no: 2, nama: "Afwan Fauzan S", nrp: "59231115242"},
    {no: 3, nama: "Ahmad Irfan Pebrivan", nrp: "59231115484"},
    {no: 4, nama: "Al Mubarak", nrp: "59231114849"},
    {no: 5, nama: "Alman Faluti", nrp: "59231115486"},
    {no: 6, nama: "Andi Zaidin Raub", nrp: "59231115645"},
    {no: 7, nama: "Arya Bayu Pratama", nrp: "59231115648"},
    {no: 8, nama: "Calvin Svadef", nrp: "59231115248"},
    {no: 9, nama: "Danu Pramana", nrp: "59231114857"},
    {no: 10, nama: "Dino Perdian", nrp: "59231115427"},
    {no: 11, nama: "Elang Sakti Massaid", nrp: "59231115497"},
    {no: 12, nama: "Faris Arva Makarim", nrp: "59234115409"},
    {no: 13, nama: "Figsan Fanshury Roja", nrp: "59231115501"},
    {no: 14, nama: "Frizzy Fawwaz Zakv", nrp: "59231115428"},
    {no: 15, nama: "Hadrianto", nrp: "59231115663"},
    {no: 16, nama: "Heribertus Bili", nrp: "59231115264"},
    {no: 17, nama: "Ilham Ihsani", nrp: "59231115268"},
    {no: 18, nama: "Jastin Sahertian", nrp: "59231115671"},
    {no: 19, nama: "Juan Dito Latuheru", nrp: "59231115675"},
    {no: 20, nama: "Kodri Azizi Rahakbauw", nrp: "59231115676"},
    {no: 21, nama: "Luthfi Ernando", nrp: "59231115515"},
    {no: 22, nama: "M. Wahyu Effendi", nrp: "59231115160"},
    {no: 23, nama: "Mas Rianto", nrp: "59231115518"},
    {no: 24, nama: "Mohammad Syahdilah Munasvar", nrp: "59231115282"},
    {no: 25, nama: "Muhamad Fatkhurrizal Ourrota A", nrp: "59231115279"},
    {no: 26, nama: "Muhammad Fachrie Winarno", nrp: "59231114875"},
    {no: 27, nama: "Muhammad Naimi Nidarahman", nrp: "59231115527"},
    {no: 28, nama: "Muhammad Sam Azis", nrp: "59231115289"},
    {no: 29, nama: "Nanda Syahputra", nrp: "59231115800"},
    {no: 30, nama: "Rafael Dara Jaha Baghi", nrp: "59231115291"},
    {no: 31, nama: "Rangga Irvanda", nrp: "59231115295"},
    {no: 32, nama: "Ridho Ahmad Wellete", nrp: "59231115695"},
    {no: 33, nama: "Riski", nrp: "59231115697"},
    {no: 34, nama: "Rizqy Ari Murti", nrp: "59231115801"},
    {no: 35, nama: "Samsudin Kotala", nrp: "59231115702"},
    {no: 36, nama: "Sheva Dwi Fatkhurrohman", nrp: "59231115536"},
    {no: 37, nama: "Sulthan Nadhif Darmawan", nrp: "59231115538"},
    {no: 38, nama: "T. Ibnu Sina", nrp: "59231115191"},
    {no: 39, nama: "Yahya Solissa", nrp: "59231115711"},
    {no: 40, nama: "Zakarias Lede Bulu", nrp: "59231115314"}
  ];

  function initializeTable() {
    const tbody = document.getElementById('attendanceBody');
    tbody.innerHTML = '';
    tarunaData.forEach(taruna => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${taruna.no}</td>
        <td>${taruna.nama}</td>
        <td>${taruna.nrp}</td>
        <td class="checkbox-cell">
          <select id="status_${taruna.no}" onchange="updateStats()">
            <option value="absen">âŒ Tidak Hadir</option>
            <option value="hadir">âœ… Hadir</option>
            <option value="izin">ğŸŸ¡ Izin</option>
          </select>
        </td>`;
      tbody.appendChild(row);
    });
  }

  function updateStats() {
    const selects = document.querySelectorAll('select[id^="status_"]');
    let hadir = 0, absen = 0, izin = 0;
    let hadirNames = [], absenNames = [], izinNames = [];

    selects.forEach((sel, i) => {
      const nama = tarunaData[i].nama;
      if (sel.value === 'hadir') { hadir++; hadirNames.push(nama); }
      else if (sel.value === 'izin') { izin++; izinNames.push(nama); }
      else { absen++; absenNames.push(nama); }
    });

    document.getElementById('totalHadir').textContent = hadir;
    document.getElementById('totalAbsen').textContent = absen;
    document.getElementById('totalIzin').textContent = izin;

    document.getElementById('hadirList').innerHTML = hadirNames.length ?
      hadirNames.map(n => `<div class="name-item">${n}</div>`).join('') :
      `<div class="name-item" style="text-align:center;color:#7f8c8d;font-style:italic;">Belum ada yang hadir</div>`;

    document.getElementById('absenList').innerHTML = absenNames.length ?
      absenNames.map(n => `<div class="name-item">${n}</div>`).join('') :
      `<div class="name-item" style="text-align:center;color:#7f8c8d;font-style:italic;">Semua taruna hadir</div>`;

    document.getElementById('izinList').innerHTML = izinNames.length ?
      izinNames.map(n => `<div class="name-item">${n}</div>`).join('') :
      `<div class="name-item" style="text-align:center;color:#7f8c8d;font-style:italic;">Tidak ada izin</div>`;
  }

  function resetStatus() {
    const selects = document.querySelectorAll('select[id^="status_"]');
    selects.forEach(sel => sel.value = 'absen');
    updateStats();
  }

  function sendWhatsApp() {
    const total = tarunaData.length;
    const selects = document.querySelectorAll('select[id^="status_"]');
    let hadir = 0, absen = 0, izin = 0;
    let absenNames = [], izinNames = [];

    selects.forEach((sel, i) => {
      if (sel.value === 'hadir') hadir++;
      else if (sel.value === 'izin') { izin++; izinNames.push(tarunaData[i].nama); }
      else { absen++; absenNames.push(tarunaData[i].nama); }
    });

    const now = new Date();
    const tanggalJam = now.toLocaleString("id-ID", {
      day: "numeric", month: "long", year: "numeric",
      hour: "2-digit", minute: "2-digit"
    });

    let message =
`Rekap apel (${tanggalJam}) TPI F

Total : ${total}
Hadir : ${hadir}
Tidak hadir : ${absen}
Izin : ${izin}

Keterangan :`;

    if (absenNames.length > 0) {
      message += `\nA. Tidak hadir`;
      absenNames.forEach((n, i) => message += `\n${i+1}. ${n}`);
    }
    if (izinNames.length > 0) {
      message += `\n\nB. Izin`;
      izinNames.forEach((n, i) => message += `\n${i+1}. ${n}`);
    }

    const tambahan = prompt("Tambahkan keterangan lainnya (opsional):", "");
    if (tambahan === null) return;
    if (tambahan.trim() !== "") {
      message += `\n\nCatatan tambahan: ${tambahan}`;
    }

    const waUrl = "https://wa.me/?text=" + encodeURIComponent(message);
    window.open(waUrl, "_blank");
  }

  function copyList(type) {
    const listElement = document.getElementById(type + 'List');
    const items = listElement.querySelectorAll('.name-item');
    let text = "";
    items.forEach(item => {
      if (!item.style.fontStyle) text += "- " + item.textContent + "\n";
    });
    if (!text.trim()) { alert("Belum ada data untuk dicopy!"); return; }
    navigator.clipboard.writeText(text).then(() => {
      alert("Daftar " + type + " berhasil dicopy!");
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    initializeTable();
    updateStats();
  });
</script>
</body>
</html>
